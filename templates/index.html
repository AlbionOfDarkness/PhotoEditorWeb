<script>
    // Меняем URL в адресной строке без перезагрузки страницы
    const cleanUrl = window.location.origin;

    window.history.pushState({}, '', cleanUrl);
</script>
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Страница с меню</title>
    <link rel="stylesheet" href="static/styles.css">
</head>
<body>


     {% if error %}
    <!-- Модальное окно для ошибок -->
    <div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="errorModalLabel">Ошибка</h5>
                </div>
                <div class="modal-body">
                    <p id="errorMessage" style="width: 250px;">{{ error if error else '' }}</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-close" data-bs-dismiss="modal">Закрыть</button>
                </div>
            </div>
        </div>
    </div>
     {% endif %}


    <!-- Правая часть (меню + шаблоны + контент) -->
    <div class="main">
        <div class="navbar">
            <div class="dropdown">
                <button>Файл</button>
                <div class="dropdown-content">
                    <a href="choose_option?file=options/download.html">Скачать</a>
                    <a href="choose_option?file=options/load.html">Загрузить</a>
                </div>
            </div>
            <div class="dropdown">
                <button>Меню 2</button>
                <div class="dropdown-content">
                    <a href="#">Пункт A</a>
                    <a href="#">Пункт B</a>
                </div>
            </div>
            <div class="dropdown">
                <button>Меню 3</button>
                <div class="dropdown-content">
                    <a href="#">Опция X</a>
                    <a href="#">Опция Y</a>
                </div>
            </div>
        </div>

        <!-- Панель шаблонов функций -->
         {% if option_top_div %} 
        <div class="option-panel">
            {% include option_top_div %} 
        </div>
        {% endif %}


        <div class="workarea">
            <div class="sidebar">
                <div class="tool-grid">
                    <a href="choose_option?file=options/load.html" class="tool-item" style="background-image: url('path1.png');">Загрузка</a>
                    <a href="choose_option?file=options/download.html" class="tool-item" style="background-image: url('path1.png');">Скачать</a>
                    <a href="choose_option?file=options/mirror.html" class="tool-item" style="background-image: url('path1.png');">Отражение</a>
                    <a href="choose_option?file=options/light_contr.html" class="tool-item" style="background-image: url('path1.png');">Яркость</a>
                    <a href="choose_option?file=options/rotate.html" class="tool-item" style="background-image: url('path1.png');">Поворот</a>
                    <a href="choose_option?file=options/color_balance.html" class="tool-item">Баланс цветов</a>
                    <a href="choose_option?file=options/noise.html" class="tool-item">Шумы</a>
                    <a href="choose_option?file=options/blur.html" class="tool-item">Размытие</a>
                    <a href="choose_option?file=options/resize.html" class="tool-item">Размер</a>
                    <a href="choose_option?file=options/crop.html" class="tool-item">Вырезать</a>
                </div>

            </div>
            <div class="content">
                {% if content %} 
                {% include content %} 
                {% else %}
                {% include 'contents/defult.html' %}
                {% endif %}
            </div>
        </div>

        <div class="footer">
        <p>Подвал</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <script src="static/scripts/error_scripts.js"></script>
    <script src="static/scripts/link.clear.js"></script>


     <script>
        // Автоматически показываем модальное окно при загрузке, если есть ошибка
        document.addEventListener('DOMContentLoaded', function() {
            {% if error %}
            showError("{{ error }}");
            {% endif %}

            // Обработка flash сообщений
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        {% if category == 'error' %}
                            showError("{{ message }}");
                        {% elif category == 'success' %}
                            showSuccess("{{ message }}");
                        {% endif %}
                    {% endfor %}
                {% endif %}
            {% endwith %}
        });
     </script>

</body>
</html>

